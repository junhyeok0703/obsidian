데이터 직무라면 한번 쯤 경험할 수 있는 이야기
- 갑작스럽게 데이터를 추출 해야하는 상황에 빠르게 데이터를 추출 후 공유할때
- 데이터를 공유한 후 , 혹시나 싶어 확인해보니 오류가 있었음
- 데이터를 다시 공유하면서 정정
이럴때 실수한다.

이럴때 데이터(정의) 결과 검증을 어떻게 할 수 있을까?에 대한 이야기



### 데이터 결과 검증을 잘하기 위한 마인드셋
데이터 결과 검증을 하지 못해서 실수할 수 있다.
다만 그실수가 반복되면 문제인것이다.
항상 그 실수 이후엥 어떻게 해야 다시 반복되지 않을지 생각하는 것이 필요하다 (회고)


### 데이터 결과 검증의 정의
SQL쿼리후 얻은 결과가 예상과 일치하는지 확인하는 과정
목적:분석결과의 정확성,신뢰성 확보


방법은 심플함.
- 내가 기대하는 예상 결과를 정의
- 쿼리 작성
- 두개가 일치하는지 비교


제일 중요한 부분
- 문제를 잘 정의하고, 미리 작성해보기
- 도메인 특수성(규칙같은거) 잘 파악하기
- SQL 쿼리 템플릿과 맥락이 유사

### 데이터 결과를 검증하는 흐름
![[Pasted image 20250125231511.png]]

### 데이터 결과 검증할 때 자주 활용하는 SQL쿼리
대표적으로 활용하는 SQL 문법
1. COUNT(\*) -> 행(로우) 수를 확인. 의도한 데이터의 행 개수가 맞는가?
2. NOT NULL -> 특정 컬럼에 NULL이 존재하는가? 필수 필드가 비어있지 않은가?
3. DISTINCT -> 데이터의 고유값을 확인해 중복 여부 확인
4. IF문,CASE WHEN: 의도가 같다면 TRUE, 아니면 FALSE

1)  + 3)
=> SELECT COUNT(DISTINCT col),COUNT(col) 두 컬럼을 보고 개수를 비교

### 데이터 결과 검증을 할때 활용하는 방식
1. 특정USER_ID로 필터링을 걸어서 확인
- 1명의 데이터 확인 (예:WHERE user_id = 402)
- 결과를 예상할 때 Raw 데이터에서 하나씩 눈으로 세고 적어둠 (예상 결과)
- 1명의 데이터의 예상 결과와 쿼리 결과가 동일한지 확인
- 다른 user_id 3~4건 더 추가해서 확인(여러 케이스가 존재할수있음)
- 3~4개에서 동일한 결과가 나오면 user_id 조건을 삭제

2.  샘플 데이터 생성하기
- WITH 문을 사용해 예시 데이터를 생성한 후, 결과를 예상하고 쿼리 작성
- 복잡한 데이터에서 하기 전에, 쿼리 자체가 올바른지 확인할 때 주로 사용
![[Pasted image 20250125232225.png]]
UNION row단위 합친다 아래로 붙인다(concat)

